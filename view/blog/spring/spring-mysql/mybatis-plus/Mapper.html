<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>文章导航布局（固定显示版）</title>

  <style>
    /* 基础样式与变量定义 */
    :root {
      --primary: #2c3e50;
      --primary-light: #34495e;
      --primary-accent: #3498db;
      --secondary: #7f8c8d;
      --light-bg: #f5f7fa;
      --white: #ffffff;
      --gray-light: #ecf0f1;
      --gray: #bdc3c7;
      --text-dark: #2c3e50;
      --text-medium: #7f8c8d;
      --text-light: #95a5a6;
      --border-color: #e1e4e8;
      --shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
      --shadow-hover: 0 4px 15px rgba(0, 0, 0, 0.12);
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      color: var(--text-dark);
      background-color: var(--light-bg);
      line-height: 1.6;
      overflow-x: hidden;
      padding-top: 60px; /* 为顶部导航栏预留空间 */
    }

    /* 布局基础类 */
    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .flex {
      display: flex;
    }

    .items-center {
      align-items: center;
    }

    .justify-between {
      justify-content: space-between;
    }

    .fixed {
      position: fixed;
    }

    .relative {
      position: relative;
    }

    .absolute {
      position: absolute;
    }

    .top-0 {
      top: 0;
    }

    .left-0 {
      left: 0;
    }

    .right-0 {
      right: 0;
    }

    .bottom-0 {
      bottom: 0;
    }

    .w-full {
      width: 100%;
    }

    .h-full {
      height: 100%;
    }

    .overflow-hidden {
      overflow: hidden;
    }

    .overflow-y-auto {
      overflow-y: auto;
    }

    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }

    .text-center {
      text-align: center;
    }

    .hidden {
      display: none !important;
    }

    .block {
      display: block;
    }

    /* 间距类 */
    .m-1 { margin: 0.25rem; }
    .m-2 { margin: 0.5rem; }
    .m-4 { margin: 1rem; }
    .m-6 { margin: 1.5rem; }
    .m-8 { margin: 2rem; }

    .mt-1 { margin-top: 0.25rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mt-4 { margin-top: 1rem; }
    .mt-6 { margin-top: 1.5rem; }
    .mt-8 { margin-top: 2rem; }
    .mt-16 { margin-top: 4rem; }

    .mb-1 { margin-bottom: 0.25rem; }
    .mb-2 { margin-bottom: 0.5rem; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }
    .mb-12 { margin-bottom: 3rem; }

    .ml-4 { margin-left: 1rem; }
    .mr-4 { margin-right: 1rem; }

    .p-1 { padding: 0.25rem; }
    .p-2 { padding: 0.5rem; }
    .p-4 { padding: 1rem; }
    .p-6 { padding: 1.5rem; }
    .p-8 { padding: 2rem; }

    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
    .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
    .py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
    .py-8 { padding-top: 2rem; padding-bottom: 2rem; }

    .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
    .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
    .px-4 { padding-left: 1rem; padding-right: 1rem; }
    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }

    .space-y-1 > * + * { margin-top: 0.25rem; }
    .space-y-2 > * + * { margin-top: 0.5rem; }
    .space-y-4 > * + * { margin-top: 1rem; }
    .space-y-6 > * + * { margin-top: 1.5rem; }

    .space-x-2 > * + * { margin-left: 0.5rem; }
    .space-x-4 > * + * { margin-left: 1rem; }
    .space-x-6 > * + * { margin-left: 1.5rem; }

    /* 文本样式类 */
    .text-xs { font-size: 0.75rem; }
    .text-sm { font-size: 0.875rem; }
    .text-base { font-size: 1rem; }
    .text-lg { font-size: 1.125rem; }
    .text-xl { font-size: 1.25rem; }
    .text-2xl { font-size: 1.5rem; }
    .text-3xl { font-size: 1.875rem; }
    .text-4xl { font-size: 2.25rem; }

    .font-light { font-weight: 300; }
    .font-normal { font-weight: 400; }
    .font-medium { font-weight: 500; }
    .font-semibold { font-weight: 600; }
    .font-bold { font-weight: 700; }

    .text-primary { color: var(--primary); }
    .text-primary-accent { color: var(--primary-accent); }
    .text-secondary { color: var(--secondary); }
    .text-white { color: var(--white); }
    .text-gray { color: var(--gray); }

    /* 背景与边框类 */
    .bg-white { background-color: var(--white); }
    .bg-light { background-color: var(--light-bg); }
    .bg-primary { background-color: var(--primary); }
    .bg-primary-accent { background-color: var(--primary-accent); }
    .bg-gray-light { background-color: var(--gray-light); }

    .border { border: 1px solid var(--border-color); }
    .border-b { border-bottom: 1px solid var(--border-color); }
    .border-r { border-right: 1px solid var(--border-color); }
    .border-l-4 { border-left: 4px solid var(--primary-accent); }

    .rounded { border-radius: 4px; }
    .rounded-md { border-radius: 6px; }
    .rounded-lg { border-radius: 8px; }

    /* 阴影与过渡类 */
    .shadow { box-shadow: var(--shadow); }
    .shadow-hover { transition: var(--transition); }
    .shadow-hover:hover { box-shadow: var(--shadow-hover); }

    .transition { transition: var(--transition); }

    /* 顶部导航栏 */
    #top-nav {
      height: 60px;
      z-index: 50;
      background-color: var(--white);
      box-shadow: var(--shadow);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      font-size: 1.25rem;
      color: var(--primary);
      text-decoration: none;
    }

    .nav-link {
      color: var(--text-medium);
      text-decoration: none;
      transition: var(--transition);
      font-weight: 500;
    }

    .nav-link:hover {
      color: var(--primary-accent);
    }

    .nav-link.active {
      color: var(--primary-accent);
    }

    .menu-toggle {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--primary);
      cursor: pointer;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      font-weight: 500;
      text-decoration: none;
      cursor: pointer;
      transition: var(--transition);
      border: none;
    }

    .btn-primary {
      background-color: var(--primary-accent);
      color: var(--white);
    }

    .btn-primary:hover {
      background-color: #2980b9;
    }

    /* 左侧章节导航 - 始终显示 */
    #left-sidebar {
      width: 240px;
      position: fixed;
      top: 60px;
      bottom: 0;
      background-color: var(--white);
      border-right: 1px solid var(--border-color);
      z-index: 40;
      overflow-y: auto;
      scrollbar-hide: auto;
    }

    /* 响应式调整左侧导航宽度 */
    @media (max-width: 1024px) {
      #left-sidebar {
        width: 200px;
      }
    }

    @media (max-width: 768px) {
      #left-sidebar {
        width: 160px;
      }
    }

    .chapter-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--primary);
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border-color);
    }

    .chapter-link {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      color: var(--text-medium);
      text-decoration: none;
      transition: var(--transition);
      border-left: 3px solid transparent;
      font-size: 0.95rem;
    }

    .chapter-link:hover {
      background-color: var(--light-bg);
      color: var(--primary-accent);
    }

    .chapter-link.active {
      background-color: rgba(52, 152, 219, 0.1);
      color: var(--primary-accent);
      border-left-color: var(--primary-accent);
    }

    /* 主内容区 - 始终为左侧导航留出空间 */
    .main-content {
      margin-left: 240px; /* 与左侧导航宽度一致 */
      padding: 2rem;
      min-height: calc(100vh - 60px);
    }

    /* 响应式调整主内容区margin */
    @media (max-width: 1024px) {
      .main-content {
        margin-left: 200px;
        padding: 1.5rem;
      }
    }

    @media (max-width: 768px) {
      .main-content {
        margin-left: 160px;
        padding: 1rem;
      }
    }

    /* 为右侧导航留出空间 */
    @media (min-width: 1200px) {
      .main-content {
        padding-right: 260px; /* 右侧导航宽度+间距 */
      }
    }

    .article-header {
      margin-bottom: 3rem;
      text-align: center;
    }

    .article-title {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: var(--primary);
    }

    .article-meta {
      color: var(--text-medium);
      font-size: 0.9rem;
    }

    /* Markdown内容样式 */
    .markdown-content h2 {
      font-size: 1.8rem;
      margin-top: 2.5rem;
      margin-bottom: 1.5rem;
      color: var(--primary);
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border-color);
    }

    .markdown-content h3 {
      font-size: 1.4rem;
      margin-top: 2rem;
      margin-bottom: 1rem;
      color: var(--primary-light);
    }

    .markdown-content p {
      margin-bottom: 1.25rem;
      line-height: 1.7;
    }

    .markdown-content ul,
    .markdown-content ol {
      margin-bottom: 1.25rem;
      padding-left: 1.5rem;
    }

    .markdown-content ul {
      list-style-type: disc;
    }

    .markdown-content ol {
      list-style-type: decimal;
    }

    .markdown-content li {
      margin-bottom: 0.5rem;
    }

    .markdown-content a {
      color: var(--primary-accent);
      text-decoration: none;
    }

    .markdown-content a:hover {
      text-decoration: underline;
    }

    .markdown-content blockquote {
      border-left: 4px solid var(--primary-accent);
      padding: 0.5rem 1rem;
      margin: 1.5rem 0;
      background-color: rgba(52, 152, 219, 0.05);
      color: var(--text-medium);
    }

/* 代码块样式 */
.markdown-content pre {
    background-color: #2d3748;
    color: #e2e8f0;
    border-radius: 0.375rem;
    padding: 1rem;
    margin-bottom: 1.25rem;
    overflow-x: auto;
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
    font-size: 0.875rem;
    line-height: 1.5;
}

.markdown-content code {
    background-color: #edf2f7;
    color: #2d3748;
    padding: 0.125rem 0.25rem;
    border-radius: 0.25rem;
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
    font-size: 0.875rem;
}

.markdown-content pre code {
    background-color: transparent;
    padding: 0;
    color: inherit;
}

    .markdown-content table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
    }

    .markdown-content th,
    .markdown-content td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    .markdown-content th {
      background-color: var(--light-bg);
      font-weight: 600;
    }

    /* 右侧悬浮二级标题导航 - 始终显示 */
    #right-sidebar {
      width: 240px;
      position: fixed;
      top: 80px;
      bottom: 80px;
      right: 20px;
      background-color: var(--white);
      border-radius: 8px;
      box-shadow: var(--shadow);
      padding: 1rem;
      overflow-y: auto;
      z-index: 30;
    }

    /* 小屏幕下调整右侧导航位置和大小 */
    @media (max-width: 1199px) and (min-width: 769px) {
      #right-sidebar {
        width: 200px;
        font-size: 0.9rem;
      }
    }

    @media (max-width: 768px) {
      #right-sidebar {
        width: 140px;
        right: 10px;
        padding: 0.75rem;
        font-size: 0.85rem;
      }
    }

    .toc-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--primary);
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border-color);
    }

    .toc-link {
      display: block;
      padding: 0.35rem 0.5rem;
      color: var(--text-medium);
      text-decoration: none;
      font-size: 0.9rem;
      border-radius: 4px;
      transition: var(--transition);
    }

    .toc-link:hover {
      background-color: var(--light-bg);
      color: var(--primary-accent);
    }

    .toc-link.active {
      background-color: rgba(52, 152, 219, 0.1);
      color: var(--primary-accent);
      font-weight: 500;
    }

    .toc-level-2 {
      padding-left: 1rem;
      font-size: 0.85rem;
    }

    /* 移除移动端控制按钮 */
    #toc-toggle, #sidebar-toggle, #overlay {
      display: none !important;
    }
  </style>
</head>

<body>
  <!-- 顶部导航栏 -->
  <header id="top-nav" class="fixed top-0 left-0 right-0 bg-white shadow">
    <div class="container flex items-center justify-between h-full px-4">
      <!-- 左侧Logo -->
      <div class="flex items-center space-x-4">
        <a href="#" class="logo">
          <span>Blog</span>
        </a>
      </div>

      <!-- 中间导航链接 -->
      <nav class="md:flex items-center space-x-6">

      </nav>

      <!-- 右侧功能区 -->
      <div class="flex items-center space-x-4">
          <a href="/sprdoc/index.html" class="nav-link active">Sprival</a>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <main class="main-content">
    <div class="container max-w-4xl">
      <article class="markdown-content bg-white rounded-lg shadow p-6 md:p-8">
          <h1>Mapper</h1>
<p>mybatis通常的用法如下：</p>
<p>定义接口</p>
<pre><code class="language-java">public interface UserMapper {
    User selectUser(int id);
}
</code></pre>
<p>定义xml文件</p>
<pre><code class="language-xml">&lt;mapper namespace=&quot;com.example.UserMapper&quot;&gt;
    &lt;select id=&quot;selectUser&quot; parameterType=&quot;int&quot; resultType=&quot;User&quot;&gt;
        SELECT * FROM users WHERE id = #{id}
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre>
<p>执行</p>
<pre><code class="language-java">class Test {
    public static void main(String[] args) {
        try (SqlSession session = sqlSessionFactory.openSession()) {
            UserMapper mapper = session.getMapper(UserMapper.class);
            User user = mapper.selectUser(1);
            System.out.println(user);
        } catch(Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<ul>
<li>这里的UserMapper实现实际上是一个代理MapperProxy。这种方式简单来说就是，定义接口，调用接口方法的时候，通过代理方式处理接口实现</li>
<li>集成到spring的时候，需要将项目中定义的所有Mapper转换为Proxy，并且注册为Bean。</li>
<li>mybatis通过MapperScan注解扫描mapper接口，注册为bean的时候的是FactoryBean模式将实现类转换为MapperProxy代理，</li>
<li>对于mybatis-plus来说，通过注册SqlSessionTemplate这个bean，将MapperProxy代理替换成自己的MybatisMapperProxy代理</li>
</ul>
<h2>主要的调用链路</h2>
<pre><code class="language-text">@MapperScan(&quot;com.soyokra.sprival.dao.*.mapper&quot;)
=&gt; MapperScan @Import({MapperScannerRegistrar.class})：注册MapperScannerRegistrar
=&gt; MapperScannerRegistrar.registerBeanDefinitions：设置MapperScannerConfigurer属性的basePackage为com.soyokra.sprival.dao.*.mapper
=&gt; MapperScannerConfigurer.postProcessBeanDefinitionRegistry
=&gt; ClassPathMapperScanner.processBeanDefinitions：扫描basePackage生成BeanDefinition，并且设置BeanClass为MapperFactoryBean
=&gt; Mapper注册为Bean的时候，通过MapperFactoryBean的getObject()转到了SqlSessionTemplate.getMapper()
=&gt; SqlSessionTemplate调用的是 getConfiguration().getMapper(type, this)。这个SqlSessionTemplate是mybatis-plus注册的Bean，Configuration是mybatis-plus的
=&gt; 最终通过mybatis-plus的MybatisMapperRegistry执行到MybatisMapperProxyFactory，生成了MybatisMapperProxy代理类作为Mapper接口的实现
</code></pre>
<h2>MapperScan</h2>
<p>@MapperScan("com.soyokra.sprival.dao.<em>.mapper")设置了需要扫描的包basePackages为"com.soyokra.sprival.dao.</em>.mapper"</p>
<pre><code class="language-java">@MapperScan(&quot;com.soyokra.sprival.dao.*.mapper&quot;)
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Documented
@Import(MapperScannerRegistrar.class)
@Repeatable(MapperScans.class)
public @interface MapperScan {
    String[] value() default {};
}
</code></pre>
<h2>MapperScannerRegistrar</h2>
<ul>
<li>MapperScan注解本身注解了@Import({MapperScannerRegistrar.class})</li>
<li>MapperScannerRegistrar这个类实现了接口ImportBeanDefinitionRegistrar</li>
<li>通过registerBeanDefinitions方法注册MapperScannerConfigurer这个类的BeanDefinition的时候， 把MapperScan注解设置需要扫描的包设置到了MapperScannerConfigurer这个类的属性basePackages</li>
</ul>
<pre><code class="language-java">public class MapperScannerRegistrar implements ImportBeanDefinitionRegistrar, ResourceLoaderAware {
    void registerBeanDefinitions(AnnotationMetadata annoMeta, AnnotationAttributes annoAttrs,
                                 BeanDefinitionRegistry registry, String beanName) {

        BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(MapperScannerConfigurer.class);

        builder.addPropertyValue(&quot;basePackage&quot;, StringUtils.collectionToCommaDelimitedString(basePackages));

        registry.registerBeanDefinition(beanName, builder.getBeanDefinition());

    }
}
</code></pre>
<h2>MapperScannerConfigurer</h2>
<ul>
<li>MapperScannerConfigurer这个类实现了BeanDefinitionRegistryPostProcessor的接口</li>
<li>在postProcessBeanDefinitionRegistry方法里实例化了ClassPathMapperScanner，通过ClassPathMapperScanner进行类文件扫描和BeanDefinition的注册</li>
</ul>
<pre><code class="language-java">public class MapperScannerConfigurer 
        implements BeanDefinitionRegistryPostProcessor, InitializingBean, ApplicationContextAware, BeanNameAware {
    @Override
    public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) {
        ClassPathMapperScanner scanner = new ClassPathMapperScanner(registry);
        scanner.setMapperFactoryBeanClass(this.mapperFactoryBeanClass);
        scanner.scan(StringUtils.tokenizeToStringArray(this.basePackage, ConfigurableApplicationContext.CONFIG_LOCATION_DELIMITERS));
    }
}
</code></pre>
<h2>ClassPathMapperScanner</h2>
<p>对basePackages下的文件进行扫描注册成BeanDefinition，并且设置了BeanDefinition的属性beanClass为MapperFactoryBean</p>
<pre><code class="language-java">public class ClassPathMapperScanner extends ClassPathBeanDefinitionScanner {
    @Override
    public Set&lt;BeanDefinitionHolder&gt; doScan(String... basePackages) {
        Set&lt;BeanDefinitionHolder&gt; beanDefinitions = super.doScan(basePackages);
        processBeanDefinitions(beanDefinitions);
        return beanDefinitions;
    }

    private void processBeanDefinitions(Set&lt;BeanDefinitionHolder&gt; beanDefinitions) {
        AbstractBeanDefinition definition;
        BeanDefinitionRegistry registry = getRegistry();
        for (BeanDefinitionHolder holder : beanDefinitions) {
            definition = (AbstractBeanDefinition) holder.getBeanDefinition();
            definition.setBeanClass(this.mapperFactoryBeanClass); // this.mapperFactoryBeanClass =&gt; MapperFactoryBean
        }
    }
}
</code></pre>
<h2>MapperFactoryBean</h2>
<ul>
<li>MapperFactoryBean实现了FactoryBean接口</li>
<li>Spring将Mapper注册为Bean的时候，用的是MapperFactoryBean的getObject()，这个方法调用到了SqlSessionTemplate.getMapper()</li>
</ul>
<pre><code class="language-java">public class MapperFactoryBean&lt;T&gt; extends SqlSessionDaoSupport implements FactoryBean&lt;T&gt; {
    @Override
    public T getObject() throws Exception {
        return getSqlSession().getMapper(this.mapperInterface);
    }

    public SqlSession getSqlSession() {
        return this.sqlSessionTemplate;
    }
}

public abstract class SqlSessionDaoSupport extends DaoSupport {
    public SqlSession getSqlSession() {
        return this.sqlSessionTemplate;
    }
}
</code></pre>
<h2>SqlSessionTemplate</h2>
<p>SqlSessionTemplate调用的是 getConfiguration().getMapper(type, this)。由于这个SqlSessionTemplate是mybatis-plus注册的Bean，Configuration实际上是mybatis-plus
实现的，最终最终通过mybatis-plus的MybatisMapperRegistry执行到MybatisMapperProxyFactory，生成了MybatisMapperProxy代理类作为Mapper接口的实现</p>
<pre><code class="language-java">public class SqlSessionTemplate implements SqlSession, DisposableBean {
    @Override
    public &lt;T&gt; T getMapper(Class&lt;T&gt; type) {
        return getConfiguration().getMapper(type, this);
    }

    @Override
    public Configuration getConfiguration() {
        return this.sqlSessionFactory.getConfiguration();
    }
}
</code></pre>
<h2>MybatisPlusAutoConfiguration</h2>
<p>mybatis-plus注册SqlSessionFactory 和 SqlSessionTemplate bean</p>
<pre><code class="language-java">public class MybatisPlusAutoConfiguration implements InitializingBean {

    @Bean
    @ConditionalOnMissingBean
    public SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {
        MybatisSqlSessionFactoryBean factory = new MybatisSqlSessionFactoryBean();
        factory.setDataSource(dataSource);
        return factory.getObject();
    }

    @Bean
    @ConditionalOnMissingBean
    public SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory) {
        ExecutorType executorType = this.properties.getExecutorType();
        return executorType != null ? new SqlSessionTemplate(sqlSessionFactory, executorType) : new SqlSessionTemplate(sqlSessionFactory);
    }
}
</code></pre>
      </article>
    </div>
  </main>



  <script>
    // 元素获取
    const chapterLinks = document.querySelectorAll('.chapter-link');
    const tocLinks = document.querySelectorAll('.toc-link');
    const sections = document.querySelectorAll('section, h3[id]');

    // 滚动监听，高亮当前章节和目录项
    window.addEventListener('scroll', () => {
      let current = '';

      // 找到当前可见的最高章节
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;

        if (window.scrollY >= (sectionTop - 150)) {
          current = section.getAttribute('id');
        }
      });

      // 更新左侧章节导航高亮
      chapterLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href').substring(1) === current ||
            current.startsWith(link.getAttribute('href').substring(1) + '-')) {
          link.classList.add('active');
        }
      });

      // 更新右侧目录导航高亮
      tocLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href').substring(1) === current) {
          link.classList.add('active');
        }
      });
    });
  </script>
</body>
</html>
