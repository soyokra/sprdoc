<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprival</title>

    <style>
        /* 基础样式与变量定义 */
        :root {
            --primary: #2c3e50;
            --primary-light: #34495e;
            --primary-accent: #3498db;
            --secondary: #7f8c8d;
            --light-bg: #f5f7fa;
            --white: #ffffff;
            --gray-light: #ecf0f1;
            --gray: #bdc3c7;
            --text-dark: #2c3e50;
            --text-medium: #7f8c8d;
            --text-light: #95a5a6;
            --border-color: #e1e4e8;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 4px 15px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            color: var(--text-dark);
            background-color: var(--light-bg);
            line-height: 1.6;
            overflow-x: hidden;
            padding-top: 60px; /* 为顶部导航栏预留空间 */
        }

        /* 布局基础类 */
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .fixed {
            position: fixed;
        }

        .relative {
            position: relative;
        }

        .absolute {
            position: absolute;
        }

        .top-0 {
            top: 0;
        }

        .left-0 {
            left: 0;
        }

        .right-0 {
            right: 0;
        }

        .bottom-0 {
            bottom: 0;
        }

        .w-full {
            width: 100%;
        }

        .h-full {
            height: 100%;
        }

        .overflow-hidden {
            overflow: hidden;
        }

        .overflow-y-auto {
            overflow-y: auto;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .text-center {
            text-align: center;
        }

        .hidden {
            display: none !important;
        }

        .block {
            display: block;
        }

        /* 间距类 */
        .m-1 {
            margin: 0.25rem;
        }

        .m-2 {
            margin: 0.5rem;
        }

        .m-4 {
            margin: 1rem;
        }

        .m-6 {
            margin: 1.5rem;
        }

        .m-8 {
            margin: 2rem;
        }

        .mt-1 {
            margin-top: 0.25rem;
        }

        .mt-2 {
            margin-top: 0.5rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mt-6 {
            margin-top: 1.5rem;
        }

        .mt-8 {
            margin-top: 2rem;
        }

        .mt-16 {
            margin-top: 4rem;
        }

        .mb-1 {
            margin-bottom: 0.25rem;
        }

        .mb-2 {
            margin-bottom: 0.5rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .mb-6 {
            margin-bottom: 1.5rem;
        }

        .mb-8 {
            margin-bottom: 2rem;
        }

        .mb-12 {
            margin-bottom: 3rem;
        }

        .ml-4 {
            margin-left: 1rem;
        }

        .mr-4 {
            margin-right: 1rem;
        }

        .p-1 {
            padding: 0.25rem;
        }

        .p-2 {
            padding: 0.5rem;
        }

        .p-4 {
            padding: 1rem;
        }

        .p-6 {
            padding: 1.5rem;
        }

        .p-8 {
            padding: 2rem;
        }

        .py-2 {
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }

        .py-3 {
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
        }

        .py-4 {
            padding-top: 1rem;
            padding-bottom: 1rem;
        }

        .py-6 {
            padding-top: 1.5rem;
            padding-bottom: 1.5rem;
        }

        .py-8 {
            padding-top: 2rem;
            padding-bottom: 2rem;
        }

        .px-2 {
            padding-left: 0.5rem;
            padding-right: 0.5rem;
        }

        .px-3 {
            padding-left: 0.75rem;
            padding-right: 0.75rem;
        }

        .px-4 {
            padding-left: 1rem;
            padding-right: 1rem;
        }

        .px-6 {
            padding-left: 1.5rem;
            padding-right: 1.5rem;
        }

        .space-y-1 > * + * {
            margin-top: 0.25rem;
        }

        .space-y-2 > * + * {
            margin-top: 0.5rem;
        }

        .space-y-4 > * + * {
            margin-top: 1rem;
        }

        .space-y-6 > * + * {
            margin-top: 1.5rem;
        }

        .space-x-2 > * + * {
            margin-left: 0.5rem;
        }

        .space-x-4 > * + * {
            margin-left: 1rem;
        }

        .space-x-6 > * + * {
            margin-left: 1.5rem;
        }

        /* 文本样式类 */
        .text-xs {
            font-size: 0.75rem;
        }

        .text-sm {
            font-size: 0.875rem;
        }

        .text-base {
            font-size: 1rem;
        }

        .text-lg {
            font-size: 1.125rem;
        }

        .text-xl {
            font-size: 1.25rem;
        }

        .text-2xl {
            font-size: 1.5rem;
        }

        .text-3xl {
            font-size: 1.875rem;
        }

        .text-4xl {
            font-size: 2.25rem;
        }

        .font-light {
            font-weight: 300;
        }

        .font-normal {
            font-weight: 400;
        }

        .font-medium {
            font-weight: 500;
        }

        .font-semibold {
            font-weight: 600;
        }

        .font-bold {
            font-weight: 700;
        }

        .text-primary {
            color: var(--primary);
        }

        .text-primary-accent {
            color: var(--primary-accent);
        }

        .text-secondary {
            color: var(--secondary);
        }

        .text-white {
            color: var(--white);
        }

        .text-gray {
            color: var(--gray);
        }

        /* 背景与边框类 */
        .bg-white {
            background-color: var(--white);
        }

        .bg-light {
            background-color: var(--light-bg);
        }

        .bg-primary {
            background-color: var(--primary);
        }

        .bg-primary-accent {
            background-color: var(--primary-accent);
        }

        .bg-gray-light {
            background-color: var(--gray-light);
        }

        .border {
            border: 1px solid var(--border-color);
        }

        .border-b {
            border-bottom: 1px solid var(--border-color);
        }

        .border-r {
            border-right: 1px solid var(--border-color);
        }

        .border-l-4 {
            border-left: 4px solid var(--primary-accent);
        }

        .rounded {
            border-radius: 4px;
        }

        .rounded-md {
            border-radius: 6px;
        }

        .rounded-lg {
            border-radius: 8px;
        }

        /* 阴影与过渡类 */
        .shadow {
            box-shadow: var(--shadow);
        }

        .shadow-hover {
            transition: var(--transition);
        }

        .shadow-hover:hover {
            box-shadow: var(--shadow-hover);
        }

        .transition {
            transition: var(--transition);
        }

        /* 顶部导航栏 */
        #top-nav {
            height: 60px;
            z-index: 50;
            background-color: var(--white);
            box-shadow: var(--shadow);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            font-size: 1.25rem;
            color: var(--primary);
            text-decoration: none;
        }

        .nav-link {
            color: var(--text-medium);
            text-decoration: none;
            transition: var(--transition);
            font-weight: 500;
        }

        .nav-link:hover {
            color: var(--primary-accent);
        }

        .nav-link.active {
            color: var(--primary-accent);
        }

        .menu-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--primary);
            cursor: pointer;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: var(--transition);
            border: none;
        }

        .btn-primary {
            background-color: var(--primary-accent);
            color: var(--white);
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        /* 左侧章节导航 - 始终显示 */
        #left-sidebar {
            width: 240px;
            position: fixed;
            top: 60px;
            bottom: 0;
            background-color: var(--white);
            border-right: 1px solid var(--border-color);
            z-index: 40;
            overflow-y: auto;
            scrollbar-hide: auto;
        }

        /* 响应式调整左侧导航宽度 */
        @media (max-width: 1024px) {
            #left-sidebar {
                width: 200px;
            }
        }

        @media (max-width: 768px) {
            #left-sidebar {
                width: 160px;
            }
        }

        .chapter-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .chapter-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            color: var(--text-medium);
            text-decoration: none;
            transition: var(--transition);
            border-left: 3px solid transparent;
            font-size: 0.95rem;
        }

        .chapter-link:hover {
            background-color: var(--light-bg);
            color: var(--primary-accent);
        }

        .chapter-link.active {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--primary-accent);
            border-left-color: var(--primary-accent);
        }

        /* 主内容区 - 始终为左侧导航留出空间 */
        .main-content {
            margin-left: 240px; /* 与左侧导航宽度一致 */
            padding: 2rem;
            min-height: calc(100vh - 60px);
        }

        /* 响应式调整主内容区margin */
        @media (max-width: 1024px) {
            .main-content {
                margin-left: 200px;
                padding: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                margin-left: 160px;
                padding: 1rem;
            }
        }

        /* 为右侧导航留出空间 */
        @media (min-width: 1200px) {
            .main-content {
                padding-right: 260px; /* 右侧导航宽度+间距 */
            }
        }

        .article-header {
            margin-bottom: 3rem;
            text-align: center;
        }

        .article-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .article-meta {
            color: var(--text-medium);
            font-size: 0.9rem;
        }

        /* Markdown内容样式 */
        .markdown-content h2 {
            font-size: 1.8rem;
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
            color: var(--primary);
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .markdown-content h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: var(--primary-light);
        }

        .markdown-content p {
            margin-bottom: 1.25rem;
            line-height: 1.7;
        }

        .markdown-content ul,
        .markdown-content ol {
            margin-bottom: 1.25rem;
            padding-left: 1.5rem;
        }

        .markdown-content ul {
            list-style-type: disc;
        }

        .markdown-content ol {
            list-style-type: decimal;
        }

        .markdown-content li {
            margin-bottom: 0.5rem;
        }

        .markdown-content a {
            color: var(--primary-accent);
            text-decoration: none;
        }

        .markdown-content a:hover {
            text-decoration: underline;
        }

        .markdown-content blockquote {
            border-left: 4px solid var(--primary-accent);
            padding: 0.5rem 1rem;
            margin: 1.5rem 0;
            background-color: rgba(52, 152, 219, 0.05);
            color: var(--text-medium);
        }

        /* 代码块样式 */
        .markdown-content pre {
            background-color: #2d3748;
            color: #e2e8f0;
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1.25rem;
            overflow-x: auto;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .markdown-content code {
            background-color: #edf2f7;
            color: #2d3748;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
            font-size: 0.875rem;
        }

        .markdown-content pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }

        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        .markdown-content th,
        .markdown-content td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .markdown-content th {
            background-color: var(--light-bg);
            font-weight: 600;
        }

        /* 右侧悬浮二级标题导航 - 始终显示 */
        #right-sidebar {
            width: 240px;
            position: fixed;
            top: 80px;
            bottom: 80px;
            right: 20px;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1rem;
            overflow-y: auto;
            z-index: 30;
        }

        /* 小屏幕下调整右侧导航位置和大小 */
        @media (max-width: 1199px) and (min-width: 769px) {
            #right-sidebar {
                width: 200px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 768px) {
            #right-sidebar {
                width: 140px;
                right: 10px;
                padding: 0.75rem;
                font-size: 0.85rem;
            }
        }

        .toc-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary);
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .toc-link {
            display: block;
            padding: 0.35rem 0.5rem;
            color: var(--text-medium);
            text-decoration: none;
            font-size: 0.9rem;
            border-radius: 4px;
            transition: var(--transition);
        }

        .toc-link:hover {
            background-color: var(--light-bg);
            color: var(--primary-accent);
        }

        .toc-link.active {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--primary-accent);
            font-weight: 500;
        }

        .toc-level-2 {
            padding-left: 1rem;
            font-size: 0.85rem;
        }

        /* 移除移动端控制按钮 */
        #toc-toggle, #sidebar-toggle, #overlay {
            display: none !important;
        }

        img {
            max-width: 100%; /* 最大宽度不超过父容器 */
            height: auto; /* 高度自动计算，保持原始比例 */
            display: block; /* 移除图片底部默认空白 */
            margin: 0 auto; /* 可选：让图片居中显示 */
        }
    </style>
</head>

<body>
<!-- 顶部导航栏 -->
<header id="top-nav" class="fixed top-0 left-0 right-0 bg-white shadow">
    <div class="container flex items-center justify-between h-full px-4">
        <!-- 左侧Logo -->
        <div class="flex items-center space-x-4">
            <a href="#" class="logo">
                <span>SPRIVAL</span>
            </a>
        </div>

        <!-- 中间导航链接 -->
        <nav class="md:flex items-center space-x-6">
        </nav>

        <!-- 右侧功能区 -->
        <div class="flex items-center space-x-4">
            <a href="/sprdoc/blog_index.html" class="nav-link active">Blog</a>
        </div>
    </div>
</header>

<!-- 左侧固定章节导航 - 始终显示 -->
<aside id="left-sidebar" class="overflow-y-auto scrollbar-hide">
    <div class="p-4">
        <h2 class="chapter-title mb-4">Sprival</h2>
        <nav class="space-y-1">
            <a href="/sprdoc/view/sprival/README.html" class="chapter-link">
                <span>快速开始</span>
            </a>
            <a href="/sprdoc/view/sprival/spring-mysql/README.html" class="chapter-link">
                <span>数据库</span>
            </a>
        </nav>
    </div>
</aside>

<!-- 主内容区 -->
<main class="main-content">
    <div class="container max-w-4xl">
        <article class="markdown-content bg-white rounded-lg shadow p-6 md:p-8">
            <h1>mongo</h1>
<h2>配置说明</h2>
<p>mongodb有两种配置方式，一种是host配置，一种是uri配置</p>
<p>host配置只支持单点模式的mongodb服务，并且无法配置额外的一些参数。</p>
<pre><code class="language-properties">spring.data.mongodb.host = host
spring.data.mongodb.port = port
spring.data.mongodb.username = username
spring.data.mongodb.password = password
spring.data.mongodb.database = database
spring.data.mongodb.authentication-database = authenticationDatabase
spring.data.mongodb.replica-set-name = replicaSetName
</code></pre>
<p>uri配置可以支持副本集的mongodb服务，并且支持丰富的可选配置项。</p>
<pre><code class="language-properties">spring.data.mongodb.uri = mongodb://username:password@10.1.100.101:27000,10.1.100.102:27000,10.1.100.103:27000/admin?replicaSet=test&amp;authSource=admin&amp;maxpoolsize=10&amp;minpoolsize=2
</code></pre>
<p>标准的mongodb uri 格式：</p>
<pre><code class="language-plaintext">mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]
</code></pre>
<h3>配置项说明</h3>
<blockquote>
<p>对应的java类是org.springframework.boot.autoconfigure.mongo.MongoProperties</p>
</blockquote>
<ul>
<li>spring.data.mongodb.host: Mongo server host. Cannot be set with URI.</li>
<li>spring.data.mongodb.port: Mongo server port. Cannot be set with URI.</li>
<li>spring.data.mongodb.uri: Mongo database URI. Cannot be set with host, port, credentials and replica set name.</li>
<li>spring.data.mongodb.database：Database name.</li>
<li>spring.data.mongodb.authentication-database: Authentication database name.</li>
<li>spring.data.mongodb.username: Login user of the mongo server. Cannot be set with URI.</li>
<li>spring.data.mongodb.password: Login password of the mongo server. Cannot be set with URI.</li>
<li>spring.data.mongodb.replica-set-name: Required replica set name for the cluster. Cannot be set with URI.</li>
<li>spring.data.mongodb.field-naming-strategy: Fully qualified name of the FieldNamingStrategy to use.</li>
<li>spring.data.mongodb.grid-fs-database: GridFS database name.</li>
<li>spring.data.mongodb.uuid-representation: Representation to use when converting a UUID to a BSON binary value.</li>
<li>spring.data.mongodb.auto-index-creation: Whether to enable auto-index creation.</li>
</ul>
<h3>uri可选参数说明</h3>
<blockquote>
<p>对应的java类是com.mongodb.ConnectionString</p>
</blockquote>
<p>Server Selection Configuration:
- serverSelectionTimeoutMS=ms: How long the driver will wait for server selection to succeed before throwing an exception.
- localThresholdMS=ms: When choosing among multiple MongoDB servers to send a request, the driver will only send that request to a server whose ping time is less than or equal to the server with the fastest ping time plus the local threshold.</p>
<p>Server Monitoring Configuration:
- heartbeatFrequencyMS=ms: The frequency that the driver will attempt to determine the current state of each server in the cluster.</p>
<p>Replica set configuration:
- replicaSet=name: Implies that the hosts given are a seed list, and the driver will attempt to find all members of the set.</p>
<p>Connection Configuration:
- ssl=true|false: Whether to connect using TLS.
- tls=true|false: Whether to connect using TLS. Supersedes the ssl option
- tlsInsecure=true|false: If connecting with TLS, this option enables insecure TLS connections. Currently this has the same effect of setting tlsAllowInvalidHostnames to true. Other mechanism for relaxing TLS security constraints must be handled in the application by customizing the javax. net. ssl. SSLContext
- sslInvalidHostNameAllowed=true|false: Whether to allow invalid host names for TLS connections.
- tlsAllowInvalidHostnames=true|false: Whether to allow invalid host names for TLS connections. Supersedes the sslInvalidHostNameAllowed option
- connectTimeoutMS=ms: How long a connection can take to be opened before timing out.
- socketTimeoutMS=ms: How long a send or receive on a socket can take before timing out.
- maxIdleTimeMS=ms: Maximum idle time of a pooled connection. A connection that exceeds this limit will be closed
- maxLifeTimeMS=ms: Maximum life time of a pooled connection. A connection that exceeds this limit will be closed</p>
<p>Connection pool configuration:
- maxPoolSize=n: The maximum number of connections in the connection pool.
- waitQueueTimeoutMS=ms: The maximum wait time in milliseconds that a thread may wait for a connection to become available.</p>
<p>Write concern configuration:
- safe=true|false
  - true: the driver ensures that all writes are acknowledged by the MongoDB server, or else throws an exception. (see also w and wtimeoutMS).
  - false: the driver does not ensure that all writes are acknowledged by the MongoDB server.
- journal=true|false
  - true: the driver waits for the server to group commit to the journal file on disk.
  - false: the driver does not wait for the server to group commit to the journal file on disk.
- w=wValue
  - The driver adds { w : wValue } to all write commands. Implies safe=true.
  - wValue is typically a number, but can be any string in order to allow for specifications like "majority"
- wtimeoutMS=ms
  - The driver adds { wtimeout : ms } to all write commands. Implies safe=true.
  - Used in combination with w</p>
<p>Read preference configuration:
- readPreference=enum: The read preference for this connection.
  - Enumerated values:
    - primary
    - primaryPreferred
    - secondary
    - secondaryPreferred
    - nearest
- readPreferenceTags=string. A representation of a tag set as a comma-separated list of colon-separated key-value pairs, e. g. "dc:ny,rack:1". Spaces are stripped from beginning and end of all keys and values. To specify a list of tag sets, using multiple readPreferenceTags, e. g. readPreferenceTags=dc:ny,rack:1;readPreferenceTags=dc:ny;readPreferenceTags=
Note the empty value for the last one, which means match any secondary as a last resort.
Order matters when using multiple readPreferenceTags.
- maxStalenessSeconds=seconds. The maximum staleness in seconds. For use with any non-primary read preference, the driver estimates the staleness of each secondary, based on lastWriteDate values provided in server isMaster responses, and selects only those secondaries whose staleness is less than or equal to maxStalenessSeconds. Not providing the parameter or explicitly setting it to -1 indicates that there should be no max staleness check. The maximum staleness feature is designed to prevent badly-lagging servers from being selected. The staleness estimate is imprecise and shouldn't be used to try to select "up-to-date" secondaries. The minimum value is either 90 seconds, or the heartbeat frequency plus 10 seconds, whichever is greatest.</p>
<p>Authentication configuration:
- authMechanism=MONGO-CR|GSSAPI|PLAIN|MONGODB-X509: The authentication mechanism to use if a credential was supplied. The default is unspecified, in which case the client will pick the most secure mechanism available based on the sever version. For the GSSAPI and MONGODB-X509 mechanisms, no password is accepted, only the username.
- authSource=string: The source of the authentication credentials. This is typically the database that the credentials have been created. The value defaults to the database specified in the path portion of the connection string. If the database is specified in neither place, the default value is "admin". This option is only respected when using the MONGO-CR mechanism (the default).
- authMechanismProperties=PROPERTY_NAME:PROPERTY_VALUE,PROPERTY_NAME2:PROPERTY_VALUE2: This option allows authentication mechanism properties to be set on the connection string.
- gssapiServiceName=string: This option only applies to the GSSAPI mechanism and is used to alter the service name. Deprecated, please use authMechanismProperties=SERVICE_NAME:string instead.</p>
<p>Server Handshake configuration:
- appName=string: Sets the logical name of the application. The application name may be used by the client to identify the application to the server, for use in server logs, slow query logs, and profile collection.</p>
<p>Compressor configuration:
- compressors=string: A comma-separated list of compressors to request from the server. The supported compressors currently are 'zlib', 'snappy' and 'zstd'.
- zlibCompressionLevel=integer: Integer value from -1 to 9 representing the zlib compression level. Lower values will make compression faster, while higher values will make compression better.</p>
<p>General configuration:
- retryWrites=true|false. If true the driver will retry supported write operations if they fail due to a network error. Defaults to true.
- retryReads=true|false. If true the driver will retry supported read operations if they fail due to a network error. Defaults to true.
- uuidRepresentation=unspecified|standard|javaLegacy|csharpLegacy|pythonLegacy. See MongoClientSettings. getUuidRepresentation() for documentation of semantics of this parameter. Defaults to "javaLegacy", but will change to "unspecified" in the next major release.</p>
<h2>监控预警</h2>
<h3>监控指标</h3>
<ul>
<li>mongodb_driver_commands_seconds_count: counter</li>
<li>mongodb_driver_commands_seconds_max: gauge</li>
<li>mongodb_driver_commands_seconds_sum: gauge</li>
<li>mongodb_driver_pool_checkedout: gauge; the count of connections that are currently in use</li>
<li>mongodb_driver_pool_size: gauge; the current size of the connection pool, including idle and  in-use members</li>
<li>mongodb_driver_pool_waitqueuesize: gauge; the current size of the wait queue for a connection from the pool</li>
</ul>
<h3>PromSQL配置</h3>
<pre><code class="language-promSQL"># 平均耗时
avg(rate(mongodb_driver_commands_seconds_sum[5m]) / rate(mongodb_driver_commands_seconds_count[5m])) by (job)

# 命令执行时间 TOP 20
topk(20, mongodb_driver_commands_seconds_max)

# 使用中的连接数
sum(mongodb_driver_pool_checkedout) by (job)

# 连接池的总大小
sum(mongodb_driver_pool_size) by (job)

# 当前等待从连接池获取连接的请求数量
sum(mongodb_driver_pool_waitqueuesize) by (job)
</code></pre>
        </article>
    </div>
</main>

<!-- 右侧悬浮二级标题导航 - 始终显示 -->
<!--  <aside id="right-sidebar" class="scrollbar-hide">-->
<!--    <h3 class="toc-title">目录导航</h3>-->
<!--    <nav class="toc-nav space-y-1">-->
<!--      <a href="/sprdoc/view/sprival/README.html" class="toc-link">1. 快速开始</a>-->
<!--      <a href="#section-1-1" class="toc-link toc-level-2">1.1 Web开发的定义与重要性</a>-->
<!--      <a href="/sprdoc/view/sprival/spring-myql/README.html" class="toc-link">2. 数据库</a>-->
<!--    </nav>-->
<!--  </aside>-->

<script>
    // 元素获取
    const chapterLinks = document.querySelectorAll('.chapter-link');
    const tocLinks = document.querySelectorAll('.toc-link');
    const sections = document.querySelectorAll('section, h3[id]');

    // 滚动监听，高亮当前章节和目录项
    window.addEventListener('scroll', () => {
        let current = '';

        // 找到当前可见的最高章节
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;

            if (window.scrollY >= (sectionTop - 150)) {
                current = section.getAttribute('id');
            }
        });

        // 更新左侧章节导航高亮
        chapterLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href').substring(1) === current ||
                current.startsWith(link.getAttribute('href').substring(1) + '-')) {
                link.classList.add('active');
            }
        });

        // 更新右侧目录导航高亮
        tocLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href').substring(1) === current) {
                link.classList.add('active');
            }
        });
    });
</script>
</body>
</html>
